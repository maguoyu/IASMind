# n8n 工作流执行 - 快速参考

## 📋 目录

- [核心概念](#核心概念)
- [快速操作](#快速操作)
- [状态说明](#状态说明)
- [常见操作](#常见操作)
- [故障排查](#故障排查)

---

## 核心概念

### 执行方式

| 方式 | 使用场景 | 配置 |
|-----|---------|------|
| **Webhook** | 推荐，支持 SSE | 填写 webhook 路径 |
| **API** | 简单执行 | 留空 webhook 路径 |

### 执行状态

| 状态 | 图标 | 说明 |
|-----|------|------|
| **idle** | - | 空闲，可配置参数 |
| **running** | 🔵 | 执行中，请等待 |
| **success** | ✅ | 成功，可查看结果 |
| **error** | ❌ | 失败，可查看错误 |

---

## 快速操作

### 基本执行流程

```
1. 点击"执行"按钮
2. 配置参数（可选）
3. 点击"提交执行"
4. 查看结果
```

### 使用 Webhook 执行

```
1. 点击"使用工作流路径"（自动填充）
2. 配置参数
3. 提交执行
```

### 快速填充参数

```
方式 1：点击"使用模板"
方式 2：点击示例按钮（简单消息/用户数据处理）
方式 3：手动输入 JSON
```

---

## 状态说明

### 🔵 执行中（Running）

**显示内容**：
- 旋转的加载动画
- "正在执行工作流..." 提示

**可用操作**：
- ❌ 无（所有输入被禁用）

**持续时间**：
- 取决于工作流复杂度（通常 1-10 秒）

---

### ✅ 执行成功（Success）

**显示内容**：
- 绿色成功提示框
- 格式化的 JSON 结果
- 复制结果按钮

**可用操作**：
- ✅ 复制结果
- ✅ 重新执行
- ✅ 关闭对话框

**结果格式**：
```json
{
  "key": "value",
  "nested": {
    "data": "example"
  }
}
```

---

### ❌ 执行失败（Error）

**显示内容**：
- 红色错误提示框
- 详细错误信息

**可用操作**：
- ✅ 重新配置参数
- ✅ 关闭对话框

**常见错误**：
- JSON 格式错误
- Webhook 路径错误
- n8n 服务不可用
- 工作流内部错误

---

## 常见操作

### 操作 1：查看并复制结果

```
执行成功后 → 查看结果 → 点击"复制结果" → 粘贴到需要的地方
```

### 操作 2：调整参数重试

```
执行成功后 → 点击"重新执行" → 修改参数 → 再次提交
```

### 操作 3：从失败中恢复

```
执行失败 → 查看错误信息 → 点击"重新配置参数" → 修正问题 → 重新提交
```

### 操作 4：验证 JSON 格式

```
输入 JSON → 实时验证 → 看到绿色提示 ✅ 或红色错误 ❌
```

---

## 故障排查

### Q: 提交按钮被禁用？

**可能原因**：
1. JSON 格式错误 → 检查红色错误提示
2. 正在执行中 → 等待执行完成
3. Webhook 路径格式错误 → 确保以 `/` 开头

**解决方案**：
- 修正 JSON 格式
- 等待当前执行完成
- 检查 webhook 路径

---

### Q: 执行失败怎么办？

**步骤**：
1. 查看详细错误信息
2. 检查 JSON 参数是否正确
3. 检查 webhook 路径是否正确
4. 检查 n8n 服务是否正常
5. 查看工作流是否配置正确

---

### Q: 看不到结果？

**可能原因**：
1. 执行还在进行中 → 等待完成
2. 使用了 Webhook 方式但工作流没有返回数据 → 检查工作流配置
3. 网络错误 → 查看浏览器控制台

**解决方案**：
- 等待执行完成
- 检查工作流的响应配置
- 刷新页面重试

---

### Q: JSON 格式总是错误？

**常见错误**：

❌ **错误示例 1**：单引号
```json
{'message': 'test'}  // 错误
```

✅ **正确**：双引号
```json
{"message": "test"}
```

---

❌ **错误示例 2**：尾随逗号
```json
{
  "message": "test",
}  // 错误
```

✅ **正确**：无尾随逗号
```json
{
  "message": "test"
}
```

---

❌ **错误示例 3**：注释
```json
{
  "message": "test"  // 这是注释，错误
}
```

✅ **正确**：无注释
```json
{
  "message": "test"
}
```

---

## 快捷键和技巧

### 技巧 1：快速格式化 JSON

使用在线工具：
- https://jsonformatter.org/
- https://jsonlint.com/

或在编辑器中格式化后粘贴。

---

### 技巧 2：保存常用参数

创建一个笔记文件保存常用的 JSON 参数：

```markdown
# 常用参数

## 测试消息
{"message": "测试"}

## 用户处理
{"user_id": "123", "action": "process"}
```

需要时直接复制粘贴。

---

### 技巧 3：验证 Webhook 路径

确保路径：
1. ✅ 以 `/` 开头
2. ✅ 与工作流中配置一致
3. ✅ 无多余空格

---

### 技巧 4：查看完整大型结果

如果结果很长：
1. 点击"复制结果"
2. 粘贴到文本编辑器
3. 使用 JSON 查看工具

推荐工具：
- VS Code
- Sublime Text
- 在线 JSON Viewer

---

## 键盘快捷键

| 操作 | 快捷键 |
|-----|--------|
| 关闭对话框 | `Esc` |
| 提交表单 | `Ctrl+Enter` (部分浏览器) |

---

## API 参考

### 执行工作流

```typescript
await n8nApi.executeWorkflow(workflowId, {
  workflow_data: {
    // 你的参数
  },
  webhook_path: "/webhook-test/example" // 可选
});
```

### 响应格式

#### 成功（API 方式）
```json
{
  "id": "execution_id",
  "finished": true,
  "data": {
    // 执行结果
  }
}
```

#### 成功（Webhook 方式）
```json
{
  // Webhook 返回的数据
}
```

---

## 图标说明

| 图标 | 含义 |
|-----|------|
| 🔵 | 执行中 |
| ✅ | 成功 |
| ❌ | 失败 |
| ⚠️ | 警告 |
| ℹ️ | 信息 |
| 🔄 | 重试 |
| 📋 | 复制 |

---

## 颜色代码

| 颜色 | 用途 | 示例 |
|-----|------|------|
| 🔵 蓝色 | 信息、执行中 | Webhook 说明、加载状态 |
| 🟢 绿色 | 成功、正确 | 执行成功、JSON 正确 |
| 🔴 红色 | 错误、失败 | 执行失败、格式错误 |
| ⚪ 灰色 | 中性 | 按钮、输入框 |

---

## 最佳实践

### ✅ 推荐做法

1. **使用 Webhook 方式**（更快、更可靠）
2. **先测试简单参数**（从基础开始）
3. **保存常用参数**（提高效率）
4. **查看完整错误**（帮助调试）
5. **复制重要结果**（避免丢失）

### ❌ 避免做法

1. **不验证 JSON 就提交**（容易出错）
2. **忽略错误信息**（难以定位问题）
3. **重复提交**（等待执行完成）
4. **关闭对话框不看结果**（浪费执行）

---

## 更新历史

- **v2.0** (2025-10-23): 重新设计，支持结果显示
- **v1.0** (2025-10-23): 初始版本，Webhook 路径提取

---

## 相关文档

- [用户指南](./n8n_execution_user_guide.md) - 详细使用教程
- [功能文档](./n8n_execution_result_display.md) - 技术实现细节
- [测试方案](./n8n_execution_test_scenarios.md) - 测试场景
- [更新日志](../CHANGELOG_n8n_execution.md) - 版本历史

---

**快速参考版本**：v2.0  
**最后更新**：2025-10-23

