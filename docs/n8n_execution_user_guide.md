# n8n 工作流执行 - 用户指南

## 快速开始

### 1. 打开执行对话框

在 n8n 管理页面，点击工作流卡片上的 **"执行"** 按钮（带参数）。

### 2. 配置执行参数

#### 方式一：使用 Webhook 执行（推荐）

1. **Webhook 路径自动填充**
   - 系统会自动检测工作流的 webhook 路径
   - 如果工作流包含 Webhook 节点，路径会自动显示在 placeholder 中
   - 点击 **"使用工作流路径"** 按钮一键填充

2. **手动输入路径**
   ```
   示例：/webhook-test/joke-webhook-sse
   
   注意：路径必须以 / 开头
   ```

3. **配置工作流参数**
   ```json
   {
     "message": "测试消息",
     "options": {
       "timeout": 30
     }
   }
   ```

#### 方式二：使用 API 执行

留空 Webhook 路径，系统将使用 n8n API 执行。

### 3. 提交执行

点击 **"提交执行"** 按钮，对话框将进入执行状态。

### 4. 查看结果

#### 执行中

- 显示旋转的加载动画
- 提示文字："正在执行工作流..."
- 所有输入和按钮被禁用

#### 执行成功

1. **成功提示**
   - 绿色提示框显示 "执行成功"
   - 标题栏显示绿色徽章

2. **查看结果**
   - 结果以格式化的 JSON 显示
   - 自动缩进，易于阅读
   - 支持滚动查看长结果

3. **可用操作**
   - **复制结果**：一键复制完整 JSON 到剪贴板
   - **重新执行**：保留当前参数，重新执行工作流
   - **关闭**：关闭对话框

#### 执行失败

1. **错误提示**
   - 红色提示框显示 "执行失败"
   - 显示详细错误信息

2. **可用操作**
   - **重新配置参数**：返回参数配置界面
   - **关闭**：关闭对话框

## 使用示例

### 示例 1：测试简单消息

```json
{
  "message": "Hello World"
}
```

**步骤：**
1. 点击 **"使用示例"** → 选择 "简单消息"
2. 点击 **"提交执行"**
3. 等待执行完成
4. 查看返回结果

### 示例 2：用户数据处理

```json
{
  "user_id": "12345",
  "action": "process",
  "data": {
    "name": "张三",
    "email": "zhangsan@example.com"
  }
}
```

**步骤：**
1. 点击示例按钮快速填充
2. 根据需要修改参数
3. 提交执行并查看结果

### 示例 3：使用 Webhook 执行

```json
{
  "topic": "笑话",
  "count": 5
}
```

**步骤：**
1. 填写 Webhook 路径：`/webhook-test/joke-webhook-sse`
2. 配置参数
3. 系统显示 "将使用 Webhook 方式执行"
4. 提交执行

## 常见问题

### Q1: 为什么建议使用 Webhook 方式？

**A:** Webhook 方式的优势：
- ✅ 更快的响应速度
- ✅ 支持流式输出（SSE）
- ✅ 更接近生产环境
- ✅ 可以测试 webhook 配置

### Q2: JSON 格式错误怎么办？

**A:** 系统会实时验证 JSON 格式：
- 红色提示表示格式错误
- 查看错误信息修复问题
- 使用 **"使用模板"** 按钮获取正确格式

### Q3: 如何快速复制结果？

**A:** 两种方式：
1. 点击 **"复制结果"** 按钮（推荐）
2. 手动选择结果文本复制

### Q4: 执行失败如何重试？

**A:** 
1. 点击 **"重新配置参数"** 按钮
2. 修改参数
3. 再次提交执行

### Q5: 可以在执行中取消吗？

**A:** 执行开始后暂不支持取消，请等待执行完成。

## 提示和技巧

### 技巧 1：使用参数模板

点击 **"使用模板"** 快速获取标准格式：

```json
{
  "input": "",
  "config": {
    "key": "value"
  }
}
```

然后根据需要修改。

### 技巧 2：保存常用参数

将常用的参数保存到文本文件或笔记中，需要时复制粘贴。

### 技巧 3：验证 Webhook 路径

确保 Webhook 路径：
- 以 `/` 开头
- 与工作流中配置的路径一致
- 没有多余的空格

### 技巧 4：查看完整结果

如果结果很长：
- 使用滚动条查看
- 使用复制按钮复制到编辑器查看
- 考虑使用 JSON 格式化工具

### 技巧 5：快速迭代测试

使用 **"重新执行"** 功能：
1. 查看结果
2. 点击 "重新执行"
3. 微调参数
4. 再次提交

无需关闭对话框，快速验证不同参数效果。

## 视觉指南

### 状态徽章说明

| 徽章 | 说明 |
|-----|------|
| 🔵 执行中 | 工作流正在运行，请稍候 |
| ✅ 执行成功 | 工作流完成，结果已就绪 |
| ❌ 执行失败 | 执行遇到错误，查看详情 |

### 颜色含义

| 颜色 | 含义 | 示例 |
|-----|------|------|
| 蓝色 | 信息提示 | Webhook 使用说明 |
| 绿色 | 成功状态 | JSON 格式正确、执行成功 |
| 红色 | 错误警告 | JSON 格式错误、执行失败 |
| 灰色 | 中性信息 | 按钮、输入框 |

## 完整工作流程图

```
┌─────────────────┐
│  点击执行按钮    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  配置参数        │
│  - Webhook 路径  │
│  - JSON 参数     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  验证参数        │
│  - JSON 格式     │
│  - 路径格式      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  提交执行        │
│  [执行中状态]    │
└────────┬────────┘
         │
         ├─────────┐
         │         │
         ▼         ▼
   ┌─────────┐ ┌──────────┐
   │ 执行成功 │ │ 执行失败  │
   └────┬────┘ └─────┬────┘
        │            │
        ▼            ▼
   ┌─────────┐ ┌──────────┐
   │查看结果  │ │查看错误   │
   │复制结果  │ │重新配置   │
   │重新执行  │ │           │
   └─────────┘ └──────────┘
```

## 最佳实践

### 1. 开发环境

- ✅ 使用 Webhook 方式测试
- ✅ 小参数快速迭代
- ✅ 利用重新执行功能
- ✅ 查看完整返回结果

### 2. 生产环境

- ✅ 仔细验证参数
- ✅ 复制结果保存记录
- ✅ 注意错误信息
- ✅ 必要时截图保存

### 3. 调试技巧

- ✅ 从简单参数开始
- ✅ 逐步增加复杂度
- ✅ 对比成功和失败的参数
- ✅ 参考执行记录历史

## 支持

如果遇到问题：

1. 查看错误提示信息
2. 检查 JSON 格式
3. 验证 Webhook 路径
4. 查看工作流配置
5. 检查 n8n 服务状态

## 总结

新的执行对话框提供：

- 🎯 **直观配置**：自动填充、参数模板、实时验证
- 📊 **实时反馈**：执行状态、加载动画、清晰提示
- ✅ **结果查看**：格式化显示、一键复制、详细错误
- 🔄 **快速迭代**：重新执行、保留参数、无缝切换

让工作流执行变得简单、高效、可靠！🚀

