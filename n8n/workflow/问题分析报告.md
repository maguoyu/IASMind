# n8n å·¥ä½œæµå¯¼å…¥ä»£ç ä¸¢å¤±é—®é¢˜åˆ†ææŠ¥å‘Š

## ğŸ“‹ é—®é¢˜æè¿°

å°† `aviation-fuel-contract-review.json` å¤åˆ¶åˆ° n8n åï¼Œä¸‰ä¸ª Python å·¥å…·èŠ‚ç‚¹çš„ä»£ç ä¸¢å¤±ï¼Œåªä¿ç•™äº† description å‚æ•°ã€‚

## ğŸ” æ ¹æœ¬åŸå› åˆ†æ

### åŸå› 1ï¼šAI Agent èŠ‚ç‚¹ç¼ºå°‘ `text` å‚æ•° âš ï¸

**é—®é¢˜èŠ‚ç‚¹ï¼š** AIåˆåŒå®¡æŸ¥ä¸“å®¶

**åŸå§‹é…ç½®ï¼ˆæ­£ç¡®ï¼‰ï¼š**
```json
{
  "parameters": {
    "text": "={{ $json.chatInput }}",  â† å¿…éœ€å‚æ•°
    "options": {
      "systemMessage": "..."
    }
  }
}
```

**ä» n8n å¯¼å‡ºçš„é…ç½®ï¼ˆé”™è¯¯ï¼‰ï¼š**
```json
{
  "parameters": {
    "options": {  â† ç¼ºå°‘ text å‚æ•°
      "systemMessage": "..."
    }
  }
}
```

**å½±å“ï¼š** 
- AI Agent æ— æ³•æ¥æ”¶è¾“å…¥
- å·¥ä½œæµæ— æ³•æ­£å¸¸è¿è¡Œ
- å¯¼è‡´å…³è”çš„å·¥å…·èŠ‚ç‚¹é…ç½®ä¸å®Œæ•´

### åŸå› 2ï¼šå·¥å…·èŠ‚ç‚¹å‚æ•°ä¸æ­£ç¡® âŒ

**é—®é¢˜èŠ‚ç‚¹ï¼š** Risk Assessment Toolã€Compliance Checkerã€Terms Extractor

**åŸå§‹é…ç½®ï¼ˆæ­£ç¡®ï¼‰ï¼š**
```json
{
  "parameters": {
    "name": "ContractRiskAssessment",  â† å·¥å…·æ ‡è¯†ç¬¦
    "description": "è¯„ä¼°èˆªæ²¹é‡‡è´­åˆåŒ...",
    "pythonCode": "# åˆåŒé£é™©è¯„ä¼°å·¥å…·\nimport json..."  â† Python ä»£ç 
  },
  "type": "@n8n/n8n-nodes-langchain.toolCode",
  "typeVersion": 1.3
}
```

**ä» n8n å¯¼å‡ºçš„é…ç½®ï¼ˆé”™è¯¯ï¼‰ï¼š**
```json
{
  "parameters": {
    "description": "è¯„ä¼°èˆªæ²¹é‡‡è´­åˆåŒ..."  â† åªæœ‰æè¿°ï¼Œå…¶ä»–éƒ½ä¸¢å¤±
  },
  "type": "@n8n/n8n-nodes-langchain.toolCode",
  "typeVersion": 1.3
}
```

**ä¸¢å¤±çš„å†…å®¹ï¼š**
- âŒ `name` å‚æ•°ï¼šå·¥å…·æ ‡è¯†ç¬¦
- âŒ `pythonCode` å‚æ•°ï¼šPython ä»£ç é€»è¾‘

## ğŸ¯ ä¸ºä»€ä¹ˆä¼šä¸¢å¤±ï¼Ÿ

### å¯èƒ½çš„åŸå› 

1. **å¯¼å…¥æ–¹å¼ä¸æ­£ç¡®**
   - ç›´æ¥å¤åˆ¶ JSON æ–‡æœ¬åˆ° n8n â†’ âŒ é”™è¯¯
   - ä½¿ç”¨ n8n "Import from File" åŠŸèƒ½ â†’ âœ… æ­£ç¡®

2. **n8n ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜**
   - JSON æ ¼å¼å¯èƒ½ä¸ n8n 1.116.2 ç‰ˆæœ¬ä¸å®Œå…¨åŒ¹é…
   - æŸäº›å‚æ•°åç§°åœ¨ä¸åŒç‰ˆæœ¬ä¸­å¯èƒ½ä¸åŒ

3. **èŠ‚ç‚¹ç±»å‹ä¸åŒ¹é…**
   - å¦‚æœ n8n å®ä¾‹ä¸­æ²¡æœ‰å®‰è£… `@n8n/n8n-nodes-langchain` æ’ä»¶
   - å¯¼å…¥æ—¶å¯èƒ½æ— æ³•æ­£ç¡®è§£æèŠ‚ç‚¹é…ç½®

4. **æµè§ˆå™¨å¤åˆ¶ç²˜è´´é—®é¢˜**
   - å¦‚æœä½¿ç”¨æµè§ˆå™¨ä»æ–‡æœ¬ç¼–è¾‘å™¨å¤åˆ¶ JSON
   - å¯èƒ½ä¸¢å¤±æˆ–æŸåæŸäº›å­—ç¬¦ï¼ˆç‰¹åˆ«æ˜¯è½¬ä¹‰å­—ç¬¦ï¼‰

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨æ­£ç¡®çš„å¯¼å…¥æ–¹æ³•ï¼ˆæ¨èï¼‰

1. **ä¸è¦**ç›´æ¥å¤åˆ¶ JSON å†…å®¹
2. åœ¨ n8n Web ç•Œé¢ä¸­ï¼š
   ```
   èœå• â†’ Import from File â†’ é€‰æ‹© JSON æ–‡ä»¶ â†’ Import
   ```
3. n8n ä¼šæ­£ç¡®è§£ææ‰€æœ‰å‚æ•°

### æ–¹æ¡ˆ2ï¼šç›´æ¥åœ¨ n8n UI ä¸­é…ç½®å·¥å…·

å¦‚æœå¯¼å…¥æ€»æ˜¯å¤±è´¥ï¼Œæ‰‹åŠ¨é…ç½®ï¼š

1. **åˆ›å»º Code Tool èŠ‚ç‚¹**
2. **é…ç½®å‚æ•°ï¼š**
   - Name: `ContractRiskAssessment`ï¼ˆå¿…é¡»æ˜¯è‹±æ–‡ï¼‰
   - Description: ä¸­æ–‡æè¿°
   - Language: Python
   - ä»£ç ï¼šä» `/home/magy/IASMind/n8n/scripts/*.py` æ–‡ä»¶å¤åˆ¶

3. **é‡å¤ä»¥ä¸Šæ­¥éª¤**åˆ›å»ºå…¶ä»–ä¸¤ä¸ªå·¥å…·

### æ–¹æ¡ˆ3ï¼šæ£€æŸ¥ n8n æ’ä»¶

ç¡®ä¿å·²å®‰è£… LangChain æ’ä»¶ï¼š

```bash
# æ£€æŸ¥ n8n å·²å®‰è£…çš„æ’ä»¶
npm list @n8n/n8n-nodes-langchain

# å¦‚æœæ²¡æœ‰ï¼Œéœ€è¦å®‰è£…
npm install @n8n/n8n-nodes-langchain
```

## ğŸ“Š å®Œæ•´çš„å‚æ•°å¯¹ç…§è¡¨

### AI Agent èŠ‚ç‚¹

| å‚æ•° | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|------|------|------|--------|
| `text` | âœ… | è¾“å…¥æ–‡æœ¬ | `={{ $json.chatInput }}` |
| `options.systemMessage` | âœ… | ç³»ç»Ÿæç¤ºè¯ | "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„..." |

### Tool Code èŠ‚ç‚¹

| å‚æ•° | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|------|------|------|--------|
| `name` | âœ… | å·¥å…·æ ‡è¯†ç¬¦ï¼ˆè‹±æ–‡ï¼‰ | `ContractRiskAssessment` |
| `description` | âœ… | å·¥å…·æè¿°ï¼ˆä¸­æ–‡ï¼‰ | "è¯„ä¼°èˆªæ²¹é‡‡è´­åˆåŒ..." |
| `pythonCode` | âœ… | Python ä»£ç  | `"# åˆåŒé£é™©è¯„ä¼°å·¥å…·\nimport json..."` |

## ğŸ”§ éªŒè¯æ¸…å•

å¯¼å…¥åæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

- [ ] AI Agent èŠ‚ç‚¹æœ‰ `text` å‚æ•°
- [ ] AI Agent èŠ‚ç‚¹æœ‰ `systemMessage`
- [ ] ä¸‰ä¸ªå·¥å…·èŠ‚ç‚¹éƒ½æœ‰ `name` å‚æ•°
- [ ] ä¸‰ä¸ªå·¥å…·èŠ‚ç‚¹éƒ½æœ‰ `pythonCode` å‚æ•°
- [ ] ä¸‰ä¸ªå·¥å…·èŠ‚ç‚¹çš„ `pythonCode` ä¸æ˜¯ç©ºçš„
- [ ] æ‰€æœ‰èŠ‚ç‚¹çš„è¿æ¥ï¼ˆconnectionsï¼‰æ­£ç¡®
- [ ] Webhook èŠ‚ç‚¹æœ‰æ­£ç¡®çš„ path
- [ ] OpenAI æ¨¡å‹èŠ‚ç‚¹æœ‰æ­£ç¡®çš„å‡­è¯

## ğŸ“ æœ€ä½³å®è·µ

### DO âœ…

1. ä½¿ç”¨ n8n UI çš„ "Import from File" åŠŸèƒ½
2. å¯¼å…¥åç«‹å³æ£€æŸ¥æ‰€æœ‰èŠ‚ç‚¹é…ç½®
3. ä½¿ç”¨ç‹¬ç«‹çš„ `.py` æ–‡ä»¶ç»´æŠ¤ä»£ç 
4. å®šæœŸå¯¼å‡ºå·¥ä½œæµå¤‡ä»½
5. åœ¨æµ‹è¯•ç¯å¢ƒå…ˆå¯¼å…¥éªŒè¯

### DON'T âŒ

1. ä¸è¦ç›´æ¥å¤åˆ¶ç²˜è´´ JSON æ–‡æœ¬åˆ° n8n
2. ä¸è¦æ‰‹åŠ¨ç¼–è¾‘ JSON ä¸­çš„è½¬ä¹‰å­—ç¬¦
3. ä¸è¦è·³è¿‡é…ç½®éªŒè¯æ­¥éª¤
4. ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒç›´æ¥å¯¼å…¥æœªæµ‹è¯•çš„å·¥ä½œæµ
5. ä¸è¦å¿˜è®°æ£€æŸ¥å·¥å…·ä»£ç æ˜¯å¦å®Œæ•´

## ğŸ†˜ æ•…éšœæ’é™¤æ­¥éª¤

å¦‚æœå¯¼å…¥åä»£ç ä»ç„¶ä¸¢å¤±ï¼š

### æ­¥éª¤1ï¼šéªŒè¯æ–‡ä»¶å®Œæ•´æ€§
```bash
# æ£€æŸ¥ JSON æ–‡ä»¶å¤§å°
ls -lh /home/magy/IASMind/n8n/workflow/aviation-fuel-contract-review.json

# æ–‡ä»¶åº”è¯¥å¤§äº 30KBï¼ˆåŒ…å«å®Œæ•´ä»£ç ï¼‰
# å¦‚æœå¤ªå°ï¼Œè¯´æ˜æ–‡ä»¶æœ¬èº«ä¸å®Œæ•´
```

### æ­¥éª¤2ï¼šæ£€æŸ¥ JSON æ ¼å¼
```bash
# éªŒè¯ JSON è¯­æ³•
cat aviation-fuel-contract-review.json | jq . > /dev/null && echo "JSON æ ¼å¼æ­£ç¡®" || echo "JSON æ ¼å¼é”™è¯¯"
```

### æ­¥éª¤3ï¼šæœç´¢å…³é”®å­—
```bash
# ç¡®è®¤ pythonCode å‚æ•°å­˜åœ¨
grep -o "pythonCode" aviation-fuel-contract-review.json | wc -l
# åº”è¯¥è¿”å› 3ï¼ˆä¸‰ä¸ªå·¥å…·èŠ‚ç‚¹ï¼‰

# ç¡®è®¤ä»£ç å†…å®¹å­˜åœ¨
grep -o "def assess_contract_risks" aviation-fuel-contract-review.json
# åº”è¯¥èƒ½æ‰¾åˆ°å‡½æ•°å®šä¹‰
```

### æ­¥éª¤4ï¼šé‡æ–°ç”Ÿæˆæ–‡ä»¶

å¦‚æœæ–‡ä»¶æŸåï¼Œä½¿ç”¨åŸå§‹çš„å®Œæ•´ç‰ˆæœ¬ï¼š
```bash
cp /home/magy/IASMind/n8n/workflow/aviation-fuel-contract-review.json \
   /home/magy/IASMind/n8n/workflow/copyjson.json
```

## ğŸ“š ç›¸å…³èµ„æº

- [n8n å¯¼å…¥å¯¼å‡ºæ–‡æ¡£](https://docs.n8n.io/workflows/export/)
- [n8n Code Node æ–‡æ¡£](https://docs.n8n.io/code/builtin/code-node/)
- [LangChain Tool Code æ–‡æ¡£](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.toolcode/)

## ğŸ’¡ æ€»ç»“

**ä»£ç ä¸¢å¤±çš„ä¸»è¦åŸå› ï¼š**
1. å¯¼å…¥æ–¹å¼ä¸æ­£ç¡®ï¼ˆå¤åˆ¶ç²˜è´´è€Œéæ–‡ä»¶å¯¼å…¥ï¼‰
2. AI Agent èŠ‚ç‚¹ç¼ºå°‘ `text` å‚æ•°
3. Tool Code èŠ‚ç‚¹ç¼ºå°‘ `name` å’Œ `pythonCode` å‚æ•°

**è§£å†³æ–¹æ¡ˆï¼š**
ä½¿ç”¨ n8n UI çš„ "Import from File" åŠŸèƒ½æ­£ç¡®å¯¼å…¥å®Œæ•´çš„ JSON æ–‡ä»¶ã€‚

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š** 2025-10-30  
**é€‚ç”¨ n8n ç‰ˆæœ¬ï¼š** 1.116.2  
**å·¥ä½œæµç‰ˆæœ¬ï¼š** aviation-fuel-contract-review v1.0


